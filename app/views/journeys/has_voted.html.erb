<div  class="w-full"
      data-controller="waitingroom-subscription"
      data-waitingroom-subscription-journey-id-value="<%= @journey.id %>"
      data-waitingroom-subscription-current-user-id-value="<%= current_user.id %>"
      data-waitingroom-subscription-current-user-status-value="<%= @journey_member.read_attribute_before_type_cast(:status) %>"
      >
  <h1 class="text-center">Tout le monde a voté ?</h1>

  <div data-waiting-room-subscription-target="waitingUser">
    <div class="flex flex-col w-full py-4 gap-2">
      <div class="w-full flex items-center justify-between">
        <h2 class="w-1/2 text-center">Les retardataires</h2>
        <h2 class="w-1/2 text-center">Les bons élèves</h2>
      </div>
      <% @journey_members.each do |journey_member| %>
        <div  id="status-<%= journey_member.id %>"
              class="w-full flex items-center gap-2 <%= journey_member.current_status_enum < 5 ? "warning" : "good" %>"
              >
          <div class="w-1/2 px-8">
            <div class="w-full flex flex-col items-center p-2 rounded-lg">
              <%= render "users/avatar", user: journey_member.user %>
              <span><%= journey_member.user.nickname %></span>
            </div>
          </div>
        </div>
      <% end %>
  </div>

  <div class="infos" data-waitingroom-subscription-target="infos">
    <% if @all_good %>
      <h2 class="text-center my-4">Les votes ont parlé !</h2>
      <%= render "journey_summary_location" %>
    <% end %>
  </div>

  <div class="fixed bottom-0 left-0 right-0 w-full p-4 bg-white border-t border-great-blue-300">
    <%= link_to journey_journey_activities_path(@journey),
                data: {turbo: false, waitingroom_subscription_target: "button"},
                class: "btn primary #{ 'disabled' unless @all_good }" do
                %>
      <%= @all_good ? "Place aux activités !" : "En attente de vos amis..." %>
    <% end %>
  </div>
</div>
